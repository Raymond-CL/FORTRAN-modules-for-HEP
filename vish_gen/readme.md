## vish-gen

### description

Generates a 3D table of parton paths traversing the Quark-Gluon Plasma (QGP), using the medium profile generated by Viscous Israel-Stewart Hydrodynamics (VISH). Please give credit to VISH and the [codes](https://github.com/chunshen1987/VISHNew) can be found on github. The module also uses *VEGAS* multi-dimensional numerical integration which can be found in the same repository `vegas-min`.

Let a particle with starting transverse coordinate $(x,y)$ and traversing along an orientation $\theta$, it propagates along a path overlapping with the expansion of the QGP medium. The interaction between the medium and the particle is known as jet quenching which can consist of gluon radiations described by [BDMPS](https://doi.org/10.1088/1126-6708/2001/09/033). The characteristic gluon radiation frequency is given as:
```math
\omega_c=\hat{q}\frac{L^2}{2}=\int d\tau~\hat{q}(\tau)\tau
```
where $\hat{q}$ is the so-called QGP transport coefficient, $L$ the path length, $\tau$ the proper time. Letting the transport coefficient be proportional to the temperature of the medium $\hat{q}\sim T^3$ by the [JET](https://doi.org/10.1103/PhysRevC.90.014909) collaboration. We have the relation $\frac{\hat{q}}{\hat{q}_0}=\frac{T^3}{T_0^3}$, which modifies our equation:
```math
\omega_c\approx C_R\hat{q}_0 \int d\tau~\frac{T(\tau)^3}{T_0^3}\tau
```
where the color factor $C_R=1$ for a quark jet and $C_R=C_A/C_F$ for a gluon jet. $\hat{q}_0$ is the transport coefficient fixed for a quark jet begins at origin $(x=0,y=0,\tau=\tau_0)$, with $\tau_0$ the initialization time of hydro. $T(\tau)$ is the temperature info which can be read from VISH, and $T_0$ the temperature at the origin.

The subroutine reads in the hydro profile data generated by VISH, and generate a 3D table of the format:  

| x  | y | $\theta$ | $\int d\tau~(T^3/T_0^3)*\tau$ |
|----|---|----------|-------------------------------|


### note

The limits

### dependencies

- The jet data generated by VISH `JetData.dat` and `JetCtl.dat` should be in the same directory.
- The VISH Fortran read file should also be in the same directory. If VISH is generated in binary, use `JetOutput-0.8.for`. If generated in HDF5, use `Jetoutputh5.for`.
- VEGAS module should also be in the same directory, and can be found in this repository `vint.f90`
- The VISH read file uses old format of writing common blocks, use `-fno-align-commons` to suppress the warnings.
One can compile with the following:
```
gfortran -c -fno-strict-overflow -fno-align-commons JetOutput-0.8.for vint.f90 vish_gen.f90 main.f90
```
