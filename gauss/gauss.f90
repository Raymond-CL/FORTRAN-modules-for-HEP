module gauss

  use, intrinsic :: iso_fortran_env, only: wp=>real64
  implicit none
  private
  public :: GL4,GL8,GL16,GL32,GL64
  
contains

  subroutine GL4(xa,xb,xn,wn)
  integer, parameter :: n=4
  real(wp), intent(in) :: xa,xb
  real(wp), intent(out) :: xn(n),wn(n)
  real(wp) :: x(n),w(n)
  real(wp) :: d
  integer :: i
  data &
    x(01)/0.3399810435848563/, &
    x(02)/0.8611363115940526/
  data &
    w(01)/0.6521451548625461/, &
    w(02)/0.3478548451374538/
  d = xb-xa
  do i = 1,n/2
    xn(n/2-i+1) = d/2d0 * (1d0 - x(i)) + xa
    xn(n/2+i) = d/2d0 * (x(i) + 1d0) + xa
    wn(n/2-i+1) = d/2d0 * w(i)
    wn(n/2+i) = d/2d0 * w(i)
  enddo
  end subroutine GL4



  subroutine GL8(xa,xb,xn,wn)
  integer, parameter :: n=8
  real(wp), intent(in) :: xa,xb
  real(wp), intent(out) :: xn(n),wn(n)
  real(wp) :: x(n),w(n)
  real(wp) :: d
  integer :: i
  data &
    x(01)/0.1834346424956498/, &
    x(02)/0.5255324099163290/, &
    x(03)/0.7966664774136267/, &
    x(04)/0.9602898564975363/
  data &
    w(01)/0.3626837833783620/, &
    w(02)/0.3137066458778873/, &
    w(03)/0.2223810344533745/, &
    w(04)/0.1012285362903763/
  d = xb-xa
  do i = 1,n/2
    xn(n/2-i+1) = d/2d0 * (1d0 - x(i)) + xa
    xn(n/2+i) = d/2d0 * (x(i) + 1d0) + xa
    wn(n/2-i+1) = d/2d0 * w(i)
    wn(n/2+i) = d/2d0 * w(i)
  enddo
  end subroutine GL8



  subroutine GL16(xa,xb,xn,wn)
  integer, parameter :: n=16
  real(wp), intent(in) :: xa,xb
  real(wp), intent(out) :: xn(n),wn(n)
  real(wp) :: x(n),w(n)
  real(wp) :: d
  integer :: i
  data &
    x(01)/0.0950125098376374/, &
    x(02)/0.2816035507792589/, &
    x(03)/0.4580167776572274/, &
    x(04)/0.6178762444026438/, &
    x(05)/0.7554044083550030/, &
    x(06)/0.8656312023878318/, &
    x(07)/0.9445750230732326/, &
    x(08)/0.9894009349916499/
  data &
    w(01)/0.1894506104550685/, &
    w(02)/0.1826034150449236/, &
    w(03)/0.1691565193950025/, &
    w(04)/0.1495959888165767/, &
    w(05)/0.1246289712555339/, &
    w(06)/0.0951585116824928/, &
    w(07)/0.0622535239386479/, &
    w(08)/0.0271524594117541/
  d = xb-xa
  do i = 1,n/2
    xn(n/2-i+1) = d/2d0 * (1d0 - x(i)) + xa
    xn(n/2+i) = d/2d0 * (x(i) + 1d0) + xa
    wn(n/2-i+1) = d/2d0 * w(i)
    wn(n/2+i) = d/2d0 * w(i)
  enddo
  end subroutine GL16



  subroutine GL32(xa,xb,xn,wn)
  integer, parameter :: n=32
  real(wp), intent(in) :: xa,xb
  real(wp), intent(out) :: xn(n),wn(n)
  real(wp) :: x(n),w(n)
  real(wp) :: d
  integer :: i
  data &
    x(01)/0.0483076656877383/, &
    x(02)/0.1444719615827965/, &
    x(03)/0.2392873622521371/, &
    x(04)/0.3318686022821277/, &
    x(05)/0.4213512761306353/, &
    x(06)/0.5068999089322294/, &
    x(07)/0.5877157572407623/, &
    x(08)/0.6630442669302152/, &
    x(09)/0.7321821187402897/, &
    x(10)/0.7944837959679424/, &
    x(11)/0.8493676137325700/, &
    x(12)/0.8963211557660521/, &
    x(13)/0.9349060759377397/, &
    x(14)/0.9647622555875064/, &
    x(15)/0.9856115115452684/, &
    x(16)/0.9972638618494816/
  data &
    w(01)/0.0965400885147278/, &
    w(02)/0.0956387200792749/, &
    w(03)/0.0938443990808046/, &
    w(04)/0.0911738786957639/, &
    w(05)/0.0876520930044038/, &
    w(06)/0.0833119242269467/, &
    w(07)/0.0781938957870703/, &
    w(08)/0.0723457941088485/, &
    w(09)/0.0658222227763618/, &
    w(10)/0.0586840934785355/, &
    w(11)/0.0509980592623762/, &
    w(12)/0.0428358980222267/, &
    w(13)/0.0342738629130214/, &
    w(14)/0.0253920653092621/, &
    w(15)/0.0162743947309057/, &
    w(16)/0.0070186100094701/
  d = xb-xa
  do i = 1,n/2
    xn(n/2-i+1) = d/2d0 * (1d0 - x(i)) + xa
    xn(n/2+i) = d/2d0 * (x(i) + 1d0) + xa
    wn(n/2-i+1) = d/2d0 * w(i)
    wn(n/2+i) = d/2d0 * w(i)
  enddo
  end subroutine GL32



  subroutine GL64(xa,xb,xn,wn)
  integer, parameter :: n=64
  real(wp), intent(in) :: xa,xb
  real(wp), intent(out) :: xn(n),wn(n)
  real(wp) :: x(n),w(n)
  real(wp) :: d
  integer :: i
  data &
    x(01)/0.0243502926634244/, &
    x(02)/0.0729931217877990/, &
    x(03)/0.1214628192961206/, &
    x(04)/0.1696444204239928/, &
    x(05)/0.2174236437400071/, &
    x(06)/0.2646871622087674/, &
    x(07)/0.3113228719902110/, &
    x(08)/0.3572201583376681/, &
    x(09)/0.4022701579639916/, &
    x(10)/0.4463660172534641/, &
    x(11)/0.4894031457070530/, &
    x(12)/0.5312794640198946/, &
    x(13)/0.5718956462026340/, &
    x(14)/0.6111553551723933/, &
    x(15)/0.6489654712546573/, &
    x(16)/0.6852363130542333/, &
    x(17)/0.7198818501716109/, &
    x(18)/0.7528199072605319/, &
    x(19)/0.7839723589433414/, &
    x(20)/0.8132653151227975/, &
    x(21)/0.8406292962525803/, &
    x(22)/0.8659993981540928/, &
    x(23)/0.8893154459951141/, &
    x(24)/0.9105221370785028/, &
    x(25)/0.9295691721319396/, &
    x(26)/0.9464113748584028/, &
    x(27)/0.9610087996520538/, &
    x(28)/0.9733268277899110/, &
    x(29)/0.9833362538846260/, &
    x(30)/0.9910133714767443/, &
    x(31)/0.9963401167719553/, &
    x(32)/0.9993050417357722/
  data &
    w(01)/0.0486909570091397/, &
    w(02)/0.0485754674415034/, &
    w(03)/0.0483447622348030/, &
    w(04)/0.0479993885964583/, &
    w(05)/0.0475401657148303/, &
    w(06)/0.0469681828162100/, &
    w(07)/0.0462847965813144/, &
    w(08)/0.0454916279274181/, &
    w(09)/0.0445905581637566/, &
    w(10)/0.0435837245293235/, &
    w(11)/0.0424735151236536/, &
    w(12)/0.0412625632426235/, &
    w(13)/0.0399537411327203/, &
    w(14)/0.0385501531786156/, &
    w(15)/0.0370551285402400/, &
    w(16)/0.0354722132568824/, &
    w(17)/0.0338051618371416/, &
    w(18)/0.0320579283548516/, &
    w(19)/0.0302346570724025/, &
    w(20)/0.0283396726142595/, &
    w(21)/0.0263774697150547/, &
    w(22)/0.0243527025687109/, &
    w(23)/0.0222701738083833/, &
    w(24)/0.0201348231535302/, &
    w(25)/0.0179517157756973/, &
    w(26)/0.0157260304760247/, &
    w(27)/0.0134630478967186/, &
    w(28)/0.0111681394601311/, &
    w(29)/0.0088467598263639/, &
    w(30)/0.0065044579689784/, &
    w(31)/0.0041470332605625/, &
    w(32)/0.0017832807216964/
  d = xb-xa
  do i = 1,n/2
    xn(n/2-i+1) = d/2d0 * (1d0 - x(i)) + xa
    xn(n/2+i) = d/2d0 * (x(i) + 1d0) + xa
    wn(n/2-i+1) = d/2d0 * w(i)
    wn(n/2+i) = d/2d0 * w(i)
  enddo
  end subroutine GL64

end module gauss
